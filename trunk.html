<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Trunk</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            text-align: center;
        }
        .search-bar {
            margin-bottom: 20px;
        }
        .card {
            display: inline-block;
            margin: 10px;
            width: 100px;
            height: 140px;
        }
        .card img {
            width: 100%;
            height: 100%;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        .message {
            margin-top: 20px;
            font-style: italic;
            color: #777;
        }
    </style>
    <script>
        let trunk = JSON.parse(localStorage.getItem('trunk')) || [];

        async function fetchCardImages() {
            const cardImages = [];
            for (const cardName of trunk) {
                const apiUrl = `https://db.ygoprodeck.com/api/v7/cardinfo.php?name=${encodeURIComponent(cardName)}`;
                try {
                    const response = await fetch(apiUrl);
                    const data = await response.json();
                    const imageUrl = data.data[0]?.card_images[0]?.image_url_small || "https://storage.googleapis.com/ygoprodeck.com/pics_small/unknown.jpg";
                    cardImages.push({ name: cardName, imageUrl });
                } catch (error) {
                    console.error(`Error fetching image for ${cardName}:`, error);
                    cardImages.push({ name: cardName, imageUrl: "https://storage.googleapis.com/ygoprodeck.com/pics_small/unknown.jpg" });
                }
            }
            displayTrunk(cardImages);
        }

        function displayTrunk(cards) {
            const trunkContainer = document.getElementById('trunk');
            trunkContainer.innerHTML = '';

            if (cards.length === 0) {
                trunkContainer.innerHTML = '<p class="message">Cards not found!</p>';
                return;
            }

            cards.forEach(card => {
                const cardDiv = document.createElement('div');
                cardDiv.className = 'card';
                cardDiv.innerHTML = `<img src="${card.imageUrl}" alt="${card.name}" title="${card.name}">`;
                trunkContainer.appendChild(cardDiv);
            });
        }

        function searchTrunk(query) {
            query = query.toLowerCase();
            const filteredCards = cardImages.filter(card => card.name.toLowerCase().includes(query));
            displayTrunk(filteredCards);
        }

        let cardImages = [];

        window.onload = async () => {
            cardImages = await fetchCardImages();
            const searchInput = document.getElementById('search-bar');
            searchInput.addEventListener('input', (e) => {
                searchTrunk(e.target.value);
            });
        };
    </script>
</head>
<body>
    <h1>Your Trunk</h1>
    <input id="search-bar" class="search-bar" type="text" placeholder="Search cards...">
    <div id="trunk"></div>
    <button onclick="window.location.href='index.html'" style="margin-top: 20px;">Back to Game</button>
</body>
</html>
